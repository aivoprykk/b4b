/**
Piibel.NET client functions.
**/function openNew(a){window.open(a);return!1}function setSelect(a,b){var c=0,d=$__(a);if(d===null)return!1;var e=d.length;for(;c<e;c++)if(b==d.options[c].value){d.options[c].selected=!0;return!0}return!1}function $__(a){typeof a=="string"&&(a=document.layers&&document.layers[a]?document.layers[a]:document.getElementById?document.getElementById(a):null);return a}window.ajax||(window.ajax={}),ajax={x:function(){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(b){return new XMLHttpRequest}}},send:function(a,b,c,d,e,f){var g=ajax.x();g.open(c,a,!0),g.onreadystatechange=function(){g.readyState==4&&b(g["response"+(e||Text)],f)},g.send(d)},load:function(a,b,c,d){var e=function(){ajax.send(a,b,"GET",null,c,d)};return setTimeout(e,0)}};var load=function(){var oo=function(e){var obj=null,type=typeof e;type==="object"?obj=e:type==="string"&&(obj=eval("("+e+")"));return obj},n=function(a){var b=a.url,c=a.result,d=typeof b;if(b&&d==="string"){var e=b.split(/\./);if(e[2]&&window[e[0]][e[1]])return window[e[0]][e[1]][e[2]]=c[e[2]];if(e[1]&&window[e[0]])return window[e[0]][e[1]]=c[e[1]];return window[b]=c[b]?c[b]:a}return d==="object"?b=c:d==="function"?b(c):!0};return function(a,b){var c=oo(a);log(" loading:e:("+a+"),b:("+b+")");if(b instanceof Array)for(var d=0,e=b.length;d<e;d++)n({url:b[d],result:c});else n({url:b,result:c});return!0}}();if(!net)var net={};net.piibel||(net.piibel={}),net.piibel={history:[],context:{page_loaded:0,bibles_loaded:0,books_loaded:0,pollid:0,unpoll:0,locked:0,active_uri:"",back_lock:0,active_div:"",next_div:"",hist_len:0,hist_pos:0,slide_dir:"pop"},state:{goy:null,book:0,bookn:"",bookt:"",booki:1,chapt:0,mode:"ptk",page:null,pages:null,show_pages:10,q:"",find:"",found:"",count:0,sens:0,rows:0,bv:[],default_bv:"EST_97",page_slide_time:500,page_slide_len:700,page_slide_enabled:1},preload:function(){var a=this.context?this:window.net.piibel;a.context.active_uri="",a.loadb(),log((new Date).getTime()+" preload done")},loadb:function(a){var b=this.context?this:window.net.piibel,c=function(){b.books[66].abbr===""&&b.books.splice(66,1),b.books.splice(66,0,{id:680,name:"------- Apokriivad ---",abbr:"apk"}),b.context.books_loaded=1,controls.mainform.biblescontrol("show"),b.context.bibles_loaded=1};ajax.load("/b2/?xbb=1&lang=et&t=json",window.load,"Text",["net.piibel.books","net.piibel.bibles"]),window.c_("net.piibel.bibles",function(){c()})},benchmark:function(a,b){var c=Date.now();for(i=0;i<(b||1e3);i++)a();var d=Date.now();return d-c},load:function(a){var b="",c="",d=this.context?this:window.net.piibel,e=d.state,f=d.context,g="",h="",i=f.hist_pos,j=(new Date).getTime(),k="";f.bibles_loaded||log(j+"bibles still empty...");if(d.lock()===!1)return!1;f.back_lock==1&&e.bv.length===0&&e.bv.push(e.default_bv),controls.mainform.biblescontrol("update"),c=d.update_querystr(a),b=c?decodeURI(c):"",f.slide_dir="pop";for(var l=0,m=d.history.length-1;m>=l;m--){h=d.history[m];if(!g&&h&&h.uri==b&&h.cur&&$__(h.cur)){g=h.cur,f.hist_pos=m;break}}c&&(c="?"+encodeURI(c)),c="/b2/"+c;if(b!=f.active_uri||e.q&&e.q.match(/random/gi)||!b&&!f.active_uri)$__("footer").style.visibility!="hidden"&&($__("waiting").style.display=""),f.active_uri=b,f.page_loaded=0,g?(f.slide_dir=net.piibel.slidesel(f.hist_pos,i),e.bookt=h.btitle,e.bookn=h.bname,e.booki=h.bid,e.pages=h.pages,e.page=h.page,e.count=h.count,e.mode=h.mode,e.find=h.find,e.q=h.q,d.rebuild($__(g))):(f.next_div=""+j,f.hist_pos=f.hist_len=d.history.length,d.history.push({prev:f.active_div,cur:f.next_div,pos:f.hist_len,uri:b,btitle:"",bname:"",bid:"",pages:"",page:"",count:"",mode:"",find:"",q:""}),ajax.load(c,d.loadXML,"XML"));d.rows&&setSelect("rows",d.rows),f.page_loaded?f.page_loaded&&d.unlock():c_("net.piibel.context.page_loaded",function(){var a=$__("q");a.value!=e.q&&(a.value=e.q),d.unlock()});return!1},lock:function(){var a=this.context?this:window.net.piibel,b=a.context;if(b.locked==1)return!1;b.locked=1,a.hashstr.unpoll();return!0},unlock:function(){var a=this.context?this:window.net.piibel;a.context.locked=0,a.hashstr.poll();return!0},update_querystr:function(a){var b="",c="",d=0,e=this.state?this.state:window.net.piibel.state;if(!a||a==="#")a="";log("update_querystr:"+a),e.bv.length&&(c=e.bv.join("&bv=")),a?b=a:(e.q&&(b+=(b?"&":"")+"q="+e.q),e.sens&&$__("q").value&&(b+=(b?"&":"")+"sens="+e.sens),c&&(d=indexOf(e.bv,e.default_bv),e.bv.length==1&&d>=0||(b+=(b?"&":"")+"bv="+c)),e.page>1&&(b+=(b?"&":"")+"lk="+e.page),e.book&&(b+=(b?"&":"")+"book="+e.book),e.chapt&&(b+=(b?"&":"")+"chapter="+e.chapt),e.rows&&e.rows>0&&e.q&&(b+=(b?"&":"")+"r="+e.rows)),b=="#"&&(b="");return b},update_request:function(a){var b=a&&a!=="#"?a:window.location.hash?window.location.hash:window.location.search,c=this.context?this:window.net.piibel,d=c.bibles||null,e=c.state,f=c.context,g=function(a,b,c,f){var g=0,h=0,i="";if(b==="q"){$__("q").value=e.q=decodeURI(f);return!0}if(b==="sens"){e.sens=f,$__("sens").checked=e.sens>0?!0:!1;return!0}if(b==="bv"){for(g=0,h=d.length;g<h;g++)if(d[g].id.match(""+f+"")){i=d[g].id;break}i&&indexOf(e.bv,i)==-1&&(e.bv[e.bv.length]=i);return!0}if((b==="lk"||b==="page")&&f>1){e.page=f;return!0}if(b==="book"){e.book=f;return!0}if(b==="chapter"){e.chapter=f;return!0}if((b==="r"||b==="rows")&&f>0){var j=$__("rows");if(j.selectedIndex!=f)for(g=0,h=j.options.length;g<h;g++){if(!j.options[g])continue;if(j.options[g].value==f){j.selectedIndex=g;break}}e.rows=f;return!0}return!0},h=function(a){var b=new RegExp("([^?#=&|]+)(=([^&|]*))?","g");a.replace(b,g);return!0};f.back_lock==1&&(e.q=$__("q").value=""),e.bv=[],log("update_request:"+a+" "+b+" "+d),b&&h(b);return!1},slidesel:function(a,b){var c="",d=net.piibel.history,e=net.piibel.context,f=d[a],g=d[b];net.piibel.state.page_slide_enabled===0?c="pop":!g||g.bid==f.bid||!g.bid||!f.bid?!g||g.bid&&!f.bid||!g.bid&&f.bid||g.page==f.page||!g.bid&&!f.bid&&g.q!=f.q?c="pop":g.page<f.page?c="rl":g.page>f.page&&(c="lr"):g.bid<f.bid?c="rl":g.bid>f.bid&&(c="lr");return c},rebuild:function(a){var b=this.state?this:window.net.piibel,c=b.state,d=b.context,e=null,f="",g=function(a){var b=c.page_slide_len;return i(d.active_div,a,"left:-"+b+"px;","left:"+b+"px;","left:0px;")},h=function(a){var b=c.page_slide_len;return i(d.active_div,a,"left:"+b+"px;","left:-"+b+"px;","left:0px;")},i=function(a,b,d,e,f){var g=$__(a),h=$__(b);emile(b,e+(b.style.visibility=="hidden"?"opacity:1;":""),{setstyle:1}),$__(b.id)||$__("scrolldiv").appendChild(b),emile(a,d,{duration:c.page_slide_time}),emile(b,f,{duration:c.page_slide_time});return!0},j=function(a,b){b.style.visibility="hidden",emile(b,"left:0px;opacity:0;",{setstyle:1}),!d.active_div||d.active_div=="bibles"?$__("scrolldiv").replaceChild(b,$__("bibles")):$__(b.id)||$__("scrolldiv").appendChild(b),$__(a)&&(emile(a,"opacity:0;",{duration:c.page_slide_time}),emile(a,"left:-"+c.page_slide_len+"px;",{setstyle:1})),emile(b,"opacity:1;",{duration:c.page_slide_time});return!0};controls.navmenu.bookflow(1),controls.navmenu.pageflow(1),controls.navmenu.pageflow(2),c.mode==="ptk"&&!c.rows&&(c.page=0),e=$__("booktitle"),f=c.mode==="ptk"?c.bookt:'Otsingu "'+c.q+'" tulemus',e.innerHTML!=f&&(e.innerHTML=f),$__("numflowend").innerHTML=c.mode==="ptk"?"peat&uuml;kk":"leitud "+c.count+" vastet",$__("hh1_sub").style.visibility=="hidden"&&emile("hh1_sub","opacity:1;"),e=$__("scrolldiv"),d.slide_dir=="rl"?g(a):d.slide_dir=="lr"?h(a):j(d.active_div||"bibles",a),d.active_div=a.id,e=$__(d.active_div);var k=e.offsetHeight;for(var l=null,m=0,n=b.bibles.length;m<n;m++){if(!b.bibles[m])continue;f=b.bibles[m].id,l=$__(f+"-"+d.active_div),f&&l!==null&&(k=l.offsetHeight>k?l.offsetHeight:k,log("test:"+f+" "+l+" "+k))}emile("scrolldiv","height:"+k+"px;",{setstyle:1}),$__("foot_toolbar").style.visibility="",$__("footer").style.visibility="",c.goy!==null&&(scroll("y",c.goy,1),c.goy=null);var o=window.location.hash;o&&(o=decodeURI(o),o=o.replace(/^#/,"")),!d.back_lock&&(d.active_uri||!b.history[d.hist_pos].uri&&!d.active_uri)&&(log("change location hash to:"+d.active_uri+" from:"+o),(d.active_uri||o)&&o!=d.active_uri&&(window.location.hash=d.active_uri?encodeURI(d.active_uri):"")),d.page_loaded=1,$__("waiting").style.display="none",c.locked&&b.unlock();return 1},addStyle:function(a,b){var c=b;if(typeof a.style.cssText=="string"){c+=a.style.cssText,a.style.cssText=c;return!1}c+=a.getAttribute("style"),a.setAttribute("style",c);return!1},loadXML:function(){var a=this.state?this:window.net.piibel,b=a.state,c=a.context,d=null,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=function(n){var o=0,p=0,q=null,r="",u=null,v=null,w=null,x=[],y=null,z=n.nodeName,A=n.nodeType,B=n.nodeValue,C=n.parentNode;if(C!==undefined&&C!==null)if(A==1){if(z=="result"){d=null,f=0,b.bookt="",b.bookn="",b.count=0,b.pages=0,b.page=0,e=g=h=i=j=k=null,a.history[c.hist_pos].mode=b.mode=n.getAttribute("list_mode"),l=document.createElement("div"),l.setAttribute("id",c.next_div),a.addStyle(l,"position:absolute;width:100%;"),r=n.getAttribute("find"),a.history[c.hist_pos].find=b.find=r?r:"",r=n.getAttribute("q"),a.history[c.hist_pos].q=b.q=r?r:"";for(o=0,p=n.childNodes.length;o<p;o++)n.childNodes[o].nodeName=="bible"&&e++}if(z=="bible"){f++,y=n.getAttribute("name");var D=parseInt(n.getAttribute("count_result"),10);g=y,D&&D>b.count&&(a.history[c.hist_pos].count=b.count=D);var E=parseInt(n.getAttribute("page"),10);a.history[c.hist_pos].page=b.page=E>0?E:0,a.history[c.hist_pos].pages=b.pages=parseInt(n.getAttribute("pages"),10),d=document.createElement("div"),d.setAttribute("id",y+"-"+c.next_div),l.appendChild(d),e>1&&(u=document.createElement("div"),r="padding: 0px;font: 6pt Verdana,sans-serif;",a.addStyle(u,r),u.innerHTML=n.getAttribute("title"),d.appendChild(u)),r=(e>1?(f>1?"padding-left: 40%;":"")+"width: 37%;":"width: 77%;")+"margin-left:23%;position:absolute;",a.addStyle(d,r)}z=="book"&&(y=n.getAttribute("id"),j=n.getAttribute("abbrev"),a.history[c.hist_pos].btitle=b.bookt=b.find?"":n.getAttribute("title"),a.history[c.hist_pos].bname=b.bookn=b.find?"":j,a.history[c.hist_pos].bid=b.booki=b.find?"":parseInt(y,10));if(z=="chapter"){y=n.getAttribute("id"),h=y;if(b.mode==="ptk"||b.mode==="loik"){var F=document.createElement("span");F.setAttribute("id",g+"-"+j+"-"+h+"-"+c.next_div),b.mode==="loik"?(F.className="ptk2",F.innerHTML="<a href=\"#\" onclick=\"$__('q').value=net.piibel.state.q='"+j+"+"+h+"';return net.piibel.load();\">"+j+" "+h+"</a>\n"):f<2&&(F.className="ptk",a.addStyle(F,"margin-left:-"+(e>1?"37.5":"17")+"%;"),F.innerHTML=y),d.appendChild(F)}}}else if(A==3&&B&&B!="\n"){v=C.nodeName,r=B;if(v=="row"){i=C.getAttribute("verse");var G=C.getAttribute("heading");G&&b.mode==="ptk"&&(F=document.createElement("div"),F.className="b",F.innerHTML=G,G='<div class="heading">'+G+"</div>\n",d.appendChild(F)),F=document.createElement("div"),F.setAttribute("id",g+"-"+j+"-"+h+"-"+i+"-"+c.next_div),F.className=v,b.mode==="ptk"||b.mode==="loik"?F.innerHTML='<span class="v'+(b.goy&&b.goy.match(new RegExp("("+j+"-"+h+"-"+i+")"))?" active":"")+'">'+i+"&nbsp;"+r+"</span>\n":(b.find&&(r=r.replace(new RegExp("("+b.find.replace(/[\+\-\*\%]/g,"")+")","gi"),'<span class="found">$1</span>')),F.innerHTML='<a class="s10" style="text-decoration:none;color:#333333;" href="?q='+j+"+"+h+"&verse="+i+'" onclick="net.piibel.state.found=\''+b.find+"';$__('q').value=net.piibel.state.q='"+j+"+"+h+'\';net.piibel.state.goy=this.parentNode.id;return net.piibel.load();"><span style="color: #01436F; font-weight: bold">'+j+" "+h+":"+i+"</span>&nbsp;"+r+"</a>\n"),d.appendChild(F)}}if(n.hasChildNodes){for(o=0,p=n.childNodes.length;o<p;o++)m(n.childNodes[o]);if(z=="result"){c.slide_dir=net.piibel.slidesel(c.hist_pos,c.hist_pos-1);return a.rebuild(l)}}return 0};return function(d){log("loading xml"),a=this.context?this:window.net.piibel,b=a.state,c=a.context;return m(d)}}(),hashstr:{poll:function(){var a=this.context?this:window.net.piibel,b=a.context;log("start polling"),b.unpoll=0,b.back_lock=0;var c=500;b.pollid||(b.pollid=setInterval(a.hashstr.poll_hash,c));return b.pollid},unpoll:function(){var a=this.context?this:window.net.piibel,b=a.context;log("stop polling"),b.unpoll=1,b.pollid&&(clearInterval(b.pollid),b.pollid=0);return b.pollid},poll_hash:function(a,b){var c=this.context?this:window.net.piibel,d=c.context;if(d.upoll>0||d.locked>0)return!1;var e="",f=window.location.hash;f&&(f=decodeURI(f),e=f.replace(/^#/,""));if(b||(d.active_uri||e)&&d.active_uri!=e){if(!b&&d.active_uri=="#"&&e==="")return!0;b||(d.back_lock=1),e||(e="#",d.active_uri&&d.active_uri!=e&&($__("q").value=""));var g=function(){c.update_request(e),c.load(e)};c.bibles?g():c_("net.piibel.bibles",g)}return!0}}};var controls={getlistener:function(a){return a.addEventListener?a.addEventListener:a.attachEvent?a.attachEvent:null},bookform:{rowscontrol:function(){var a="rows",b=null,c=null,d=function(){b||(b=$__(a)),c=net.piibel.state},e=function(a){var b=a?a:window.event;return __onenter(b)},f=function(){c[a]=b.options[b.selectedIndex].value,net.piibel.load()},g=function(){b||d(),b.onkeypress=function(a){return e(a)},b.onchange=function(){return f()}};g();return function(b){d(),log("controls.bookform.rowcontrol.todo:"+b+" "+c[a]);return b=="onkeypress"?e():b=="onchange"?f():c}}(),bookselect:function(){var a="bookselect",b=null,c=null,d=0,e=function(){b||(b=$__(a)),c=net.piibel.books},f=function(a){var c=a.abbr,d=document.createElement("option");d.setAttribute("value",c.toLowerCase()),d.appendChild(document.createTextNode(a.name+"("+c+")")),b.appendChild(d)},g=function(a){a||(a=c);var e=$__("bookinput").value.toLowerCase(),g=e.length;while(b.firstChild!==null)b.removeChild(b.firstChild);var h=0,i=0;while(a[h]!==undefined){if(a[h].abbr.toLowerCase().substring(0,g)==e&&g>0||g===0)f(a[h]),i++;h++}d=i,log("booksel:"+a.length+" "+d)},h=function(a){var b=a?a:window.event;return __onenter(b)},i=function(){$__("q").value=$__("bookinput").value=net.piibel.state.q=b.options[b.selectedIndex].value,net.piibel.load()},j=function(){b||e(),b.onkeypress=function(a){return h(a)},b.onchange=function(){return i()}};j();return function(a,b){e();return a=="listen"||a=="listener"?g(b):null}}(),bookinput:function(){var a="bookinput",b=null,c=null,d=function(){b||(b=$__(a)),c=net.piibel.state},e=function(a){var b=a?a:window.event;return __onenter(b)},f=function(a){var b=a?a:window.event,c=b.target?b.target:b.srcElement?b.srcElement:null;net.piibel.state.q=c.value,controls.bookform.bookselect("listen")},g=function(){b||d(),b.onkeypress=function(a){return e(a)},b.onkeyup=function(a){return f(a)}};g();return function(g){d();return g=="onkeypress"?e():g=="onkeyup"?f():g=="obj"?b:g=="n"?a:c.q}}(),bookbutton:function(){var a="bookbutton",b=null,c=null,d=function(){return net.piibel.load()},e=function(){b||(b=$__(a)),c=net.piibel.state},f=function(){b||e(),b.onclick=d};f();return function(a){e();return a=="onclick"?d():c.sens}}(),bookdiv:function(){var a="bookdiv",b=null,c=null,d="25px",e="0px",f=function(){b||(b=$__(a))},g=function(){return b.parentNode.style.height},h=function(){e=e==d?d:"0px",e=="0px"?(b.style.opacity="0",b.style.visibility="hidden",b.style.display=="none"&&(b.style.display=""),console.log("bookdiv show requested "+e),emile(b.parentNode,"height:25px",{after:function(){emile(b,"opacity:1")}})):(console.log("bookdiv hide requested "+e),emile(b,"opacity:0",{after:function(){emile(b.parentNode,"height:0px")}}));return!1};return function(a){f(),e=g(),a&&(a=="show"&&(e="0px"),a=="hide"&&(e=d)),e!=d&&controls.bookform.bookselect("listen"),h();return!1}}()},mainform:{queryinput:function(){var a="q",b=null,c=null,d=function(){b||(b=$__(a)),c=net.piibel.state},e=function(){select()},f=function(d){var e=d?d:window.event;c[a]=b.value;return __onenter(e)},g=function(){c.q=b.value},h=function(){b||d(),b.onkeypress=function(a){return f(a)},b.onkeyup=function(){return g()}};h();return function(a){d();return a=="onkeypress"?f():a=="onkeyup"?g():a=="onfocus"?e():c.q}}(),senscheck:function(){var a="sens",b=null,c=null,d=function(){b||(b=$__(a)),c=window.net.piibel.state},e=function(){c[a]=b.checked===!0?1:0,c.q&&net.piibel.load()},f=function(){b||d(),b.onclick=function(){return e()}};f();return function(a){d();return a=="onclick"?e():c.sens}}(),biblescontrol:function(){var a="bible_select",b=null,c=null,d=null,e=null,f=-1,g=[],h=function(){b||(b=$__(a)),c=window.net.piibel,d=c.state,e=c.bibles;for(var f="",h=0,i=e.length;h<i;h++){if(!e[h])continue;f=e[h].id,g[h]=f}},i=function(){var a=e.length,b=d.bv.length,c="",i="",j=0,k=0;g.length<1&&h(),b||(f++,f==a&&(f=0),i=g[f],d.bv[b]=i,i="input_"+i,$__(i).checked=!0);var l=d.bv.join(" ");for(c="",i="",j=0,k=g.length;j<k;j++){if(!g[j])continue;i=g[j],c=l.match(""+i+""),log("update_bv:"+i),c&&log("update_bv:"+i+" match"),i="input_"+i,$__(i).checked=c?!0:!1}return!1},j=function(a){var b=a?a:window.event,c=b.target?b.target:b.srcElement?b.srcElement:null;if(!c)return!0;c.nodeType==3&&(ne=ne.parentNode);var e=c.name||c.id.replace(/input_/,""),h=indexOf(d.bv,e);c!==null&&(c.checked===!0&&h<0?d.bv[d.bv.length]=e:c.checked===!1&&h>=0&&(d.bv.length==1&&(f=indexOf(g,d.bv[0])),d.bv.splice(h,1),log("reg_bv uncheck:"+c.id+" "+d.bv.length)));return!0},k=function(a){net.piibel.state.unpoll=1,j(a),net.piibel.load(),$__("q").select()},l=function(){(!b||!e)&&h();for(var a="",c=0,d=g.length;c<d;c++){if(!g[c])continue;a=g[c],a="input_"+a,$__(a).onclick=k}},m=function(){l();return!1};return function(a,b){h();if(!e.length){log("biblescontrol error:net.piibel.bibles empty...");return!0}return a=="show"?m():a=="update"?i():a=="reg"?j(b):!0}}(),querybutton:function(){var a="querybutton",b=null,c=null,d=function(){net.piibel.state.q=$__("q").value,net.piibel.state.page=0;return net.piibel.load()},e=function(){b||(b=$__(a)),c=net.piibel.state},f=function(){b||e(),b.onclick=d};f();return function(a){e();return a=="onclick"?d():c.sens}}()},navmenu:{page:1,show_pages:20,show_aver:0,bookn:"",mkv:function(a,b,c,d){c=c?c:"net.piibel.state.q",d=d?d:"";return c+"='"+d+a+"';"+(b?"$__('q').value='';":"")},apr:function(a,b,c,d,e){return"<a "+(a?' id="'+a+'"':"")+'href="'+b+'" onclick="net.piibel.context.unpoll=1;'+c+'return net.piibel.load();"'+(d?' class="'+d+'"':"")+">"+e+"</a>"},chq:function(){var a=net.piibel.state;return a.mode==="ptk"&&(!a.rows||a.rows===0)?1:0},nav:function(a,b,c,d,e){a.onclick=function(a){log(b+"="+c),net.piibel.context.unpoll=1,net.piibel.state[b]=(d?d:0)+c,e&&($__("q").value="");return net.piibel.load()}},bookflow:function(a){a===null&&(a=1);var b=$__("bookflow"+a);if(!b)return!0;var c=this.chq(),d=net.piibel.state,e=net.piibel.books;if(c==1){var f=0,g=2,h=76,i="net.piibel.state.q";if(e[0]){h=e.length;if(!d.booki)return null;var j=parseInt(d.booki,10);j<2?f=e[0].abbr:j==68?f=e[j-3].abbr:(log("bookflow test:"+j+" "+a+" "),f=e[j-2].abbr),j>h-1?g=e[h-1].abbr:j==66?g=e[j+1].abbr:g=e[j].abbr}b!==null&&(b.innerHTML=j>1?this.apr("bookprev","#",this.mkv(f,c),"c10","eelmine"):'<span class="c10">eelmine</span>',b.innerHTML+=j<h?this.apr("booknext","#",this.mkv(g,c),"c10","j&auml;rgmine"):'<span class="c10">j&auml;rgmine</span>')}else b!==null&&(b.innerHTML="");return!0},pageflow:function(a){a===null&&(a=1);var b=$__("numflow"+a);if(!b)return!0;var c=net.piibel.state,d=parseInt(c.pages,10),e=parseInt(c.page,10);log("pageflow page:"+e+" "+d);var f=d<c.show_pages?d:c.show_pages,g=parseInt(f/2,10),h=g-1,i=f-1,j=e>g&&d>=f?e>d-g?d-i:e-g:1,k=e<=d-g&&d>=f?e>g?e+h:f:d,l="net.piibel.state.page",m="",n="",o=this.chq(),p=0,q=null;o==1&&(l="net.piibel.state.q",net.piibel.books[0]&&(m=c.bookn+" ")),n=e>1?this.apr(null,"#",this.mkv(1,o,l,m),"b s10","&laquo;"):'<span class="c10">&laquo</span>',e>1&&(q=$__("left"))&&this.nav(q,l.replace(/net.piibel.state./,""),e-1,m,o),n+=e>1?this.apr(null,"#",this.mkv(e-1,o,l,m),"c10","eelmine"):'<span class="c10">eelmine</span>';for(p=j;p<=k;p++){var r=this.mkv(p,o,l,m);n+=this.apr(null,r,r,e==p||e===0&&p==1?"active b s10":"",p<10?"&nbsp;"+p:p)+(p<f?",":"")}n+=e<d&&d>1?this.apr(null,"#",this.mkv(e?e+1:e+2,o,l,m),"c10","j&auml;rgmine"):'<span class="c10">j&auml;rgmine</span>',e<d&&d>1&&(q=$__("right"))&&this.nav(q,l.replace(/net.piibel.state./,""),e?e+1:e+2,m,o),n+=e<d&&d>1?this.apr(null,"#",this.mkv(d,o,l,m),"b s10","&raquo;"):'<span class="c10">&raquo;</span>',n='<span style="margin-right:10%;">'+n+'<span id="numflowend" class="c10" text-align:left;"></span></span>',b.innerHTML=n},bookformlink:function(){var a="bookformlink",b=null,c=null,d=0,e=function(){controls.bookform.bookdiv();return!1},f=function(){controls.bookform.bookdiv("show");return!1},g=function(){controls.bookform.bookdiv("hide");return!1},h=function(){b||(b=$__(a)),c=net.piibel.state},i=function(){d||(b||h(),b.onclick=function(){return e()},d=1)};i();return function(a){h();return a=="onclick"?e():c}}()}};window.indexOf||(window.indexOf=function(a,b){if(a===0||a===null)return-1;var c=new Object(a),d=c.length>>>0;if(d===0)return-1;var e=0;arguments.length>1&&(e=Number(arguments[2]),e!==e?e=0:e!==0&&e!==1/0&&e!==-Infinity&&(e=(e>0||-1)*Math.floor(Math.abs(e))));if(e>=d)return-1;var f=e>=0?e:Math.max(d-Math.abs(e),0);for(;f<d;f++)if(f in c&&c[f]===b)return f;return-1});var scroll=function(){var a=function(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0},b=function(a,b){var c=$__(a);b===null?b=0:b=window.innerHeight/2;if(c===null)return 0;var d=c.offsetTop,e=c;while(e.offsetParent&&e.offsetParent!=document.body)e=e.offsetParent,d+=e.offsetTop;return b===0?d:d>b?d-b:0},c=function(c,d){var e=a(),f=b(c,d),g=f>e?f-e:e-f;if(g<100)scrollTo(0,f);else{var h=Math.round(g/100);h>=20&&(h=20);var i=Math.round(g/25),j=f>e?e+i:e-i,k=0,l=0;if(f>e){for(l=e;l<f;l+=i)setTimeout(function(a){return function(){window.scrollTo(0,a)}}(j),k*h),j+=i,j>f&&(j=f),k++;return}for(l=e;l>f;l-=i)setTimeout(function(a){return function(){window.scrollTo(0,j)}}(j),k*h),j-=i,j<f&&(j=f),k++}};return function(a,b,d){c(b,d)}}(),cookie={set:function(a,b,c,d,e,f,g,h){var i=a+"="+escape(b);if(c){var j=new Date(c,d,e);i+="; expires="+j.toGMTString()}f&&(i+="; path="+escape(f)),g&&(i+="; domain="+escape(g)),h&&(i+="; secure"),document.cookie=i},clear:function(a){var b=new Date;b.setTime(b.getTime()-1),document.cookie=a+="=; expires="+b.toGMTString()},get:function(a){var b=document.cookie.match("(^|;) ?"+a+"=([^;]*)(;|$)");return b?unescape(b[2]):null},refresh:function(a,b){var c=new Date,d=c.getMonth(),e=c.getDate();e=e>28?28:e;var f=c.getFullYear();this.get(a)!==null&&this.clear(a),this.set(a,b,f+1,d,e)}}